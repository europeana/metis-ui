<ng-template #empty_date><span class="date-and-time"></span></ng-template>

<app-notification
  [notification]="notification"
  (closed)="notification = undefined"
></app-notification>

<div class="table-grid history">
  <div class="table-grid-header">
    {{ 'workflow step' | translate }}
  </div>
  <div class="table-grid-header">
    {{ 'processed-records' | translate }}
  </div>
  <div class="table-grid-header date-header">
    {{ 'starttime' | translate }}
  </div>
  <div class="table-grid-header date-header">
    {{ 'endtime' | translate }}
  </div>
  <div class="table-grid-header"></div>

  <ng-container *ngFor="let wpe of allExecutions; trackBy: byId">
    <div
      *ngIf="!wpe.pluginExecution && wpe.execution; let execution"
      class="sub-header workflow-head"
    >
      <div
        class="head-text"
        (dblclick)="copyInformation('execution', execution.id, execution.ecloudDatasetId)"
        title="{{ 'doubleclicktocopy' | translate }}"
      >
        <span class="head-prefix">{{ 'workflowcreated' | translate }}</span>
        {{ execution.createdDate | date: 'dd/MM/yyyy HH:mm' }}
        <div class="head-right" *ngIf="(getCancelledBy(execution) | async) as canceller">
          <span class="head-prefix">{{ 'cancelled-by' | translate }}</span>
          {{ canceller }}
        </div>
      </div>
    </div>

    <ng-container *ngIf="wpe.pluginExecution; let plugin">
      <app-executions-grid-data
        #dataWrapper
        [plugin]="wpe.pluginExecution"
        [wpe]="wpe"
        (openPreview)="goToPreview($event)"
        (setReportMsg)="openFailReport($event)"
      ></app-executions-grid-data>
      <ng-content *ngTemplateOutlet="dataWrapper.gridDataTemplate"></ng-content>
    </ng-container>
  </ng-container>

  <span *ngIf="hasMore" class="table-grid-footer" (click)="loadNextPage()">
    <a class="load-more-btn">{{ 'loadmore' | translate }}</a>
  </span>
</div>
