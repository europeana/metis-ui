<table class="table-horizontal-layout history-table">
  <thead>
    <tr>
      <th colspan="2"></th>
      <th>{{ 'workflow step' | translate }}</th>
      <th class="centered">{{ 'totalprocessed' | translate }}</th>
      <th class="centered">{{ 'totaldataset' | translate }}</th>
      <th>{{ 'status' | translate }}</th>
      <th class="centered">{{ 'startdate' | translate }}</th>
      <th class="centered">{{ 'enddate' | translate }}</th>
      <th colspan="2"></th>
    </tr>
  </thead>
  <tbody>
    <tr
      *ngFor="let plugin of pluginExecutions; trackBy: byId"
      [ngClass]="{ running: plugin === currentPlugin }"
    >
      <td class="centered"><span class="svg-icon-{{ plugin.pluginType }}"></span></td>
      <td class="errorindicator">
        <span class="status {{ getPluginStatusClass(plugin) }}"></span>
      </td>
      <td
        class="nowrap uppercase"
        (dblclick)="copyInformation('plugin', plugin.externalTaskId, plugin.id)"
      >
        <span class="tooltip" title="{{ 'doubleclicktocopy' | translate }}">
          {{ plugin.pluginType | renameWorkflow }} {{ plugin.workflowCreated }}</span
        >
      </td>
      <td class="nowrap centered">
        <span *ngIf="plugin.executionProgress">
          {{ plugin.executionProgress.processedRecords - plugin.executionProgress.errors }}
          <span class="errors" *ngIf="plugin.executionProgress.errors > 0"
            >({{ plugin.executionProgress.errors }})</span
          >
        </span>
      </td>
      <td class="nowrap uppercase centered">
        {{
          plugin.executionProgress && plugin.executionProgress.expectedRecords >= 0
            ? plugin.executionProgress.expectedRecords
            : ('unknown' | translate)
        }}
      </td>
      <td class="nowrap">{{ plugin.pluginStatus }}</td>
      <td class="centered">
        <span class="date">{{ plugin.startedDate | date: 'dd/MM/yyyy' }}</span>
        <span class="datedivider">-</span>
        <span class="time">{{ plugin.startedDate | date: 'HH:mm' }}</span>
      </td>
      <td class="centered">
        <span class="date">{{ plugin.finishedDate | date: 'dd/MM/yyyy' }}</span>
        <span class="datedivider">-</span>
        <span class="time">{{ plugin.finishedDate | date: 'HH:mm' }}</span>
      </td>
      <td class="buttonplaceholder nowrap">
        <a
          *ngIf="plugin.failMessage || plugin.hasReport"
          class="table-btn svg-icon-report"
          (click)="
            openFailReport(
              plugin.hasReport ? plugin.topologyName : undefined,
              plugin.hasReport ? plugin.externalTaskId : undefined,
              plugin.failMessage
            )
          "
        >
          {{ 'report' | translate }}
        </a>
      </td>
    </tr>
  </tbody>
  <tfoot>
    <tr class="loadmore loadmore-history">
      <td colspan="10">
        <a
          class="load-more-btn"
          routerLink="/dataset/log/{{ datasetId }}"
          (click)="scroll(starttab)"
          >{{ 'fullhistory' | translate }}</a
        >
      </td>
    </tr>
  </tfoot>
</table>
<div #starttab></div>
