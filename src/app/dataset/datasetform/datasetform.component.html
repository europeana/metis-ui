<div class="metis-form metis-form-horizontal">
  <form [formGroup]="datasetForm" #formDir="ngForm">
    <app-notification
      [notification]="notification"
      (closed)="notification = undefined"
    ></app-notification>

    <div class="form-fields">
      <div class="form-group" *ngIf="!isNew">
        <label>{{ 'identifier' | translate }}</label> <span>{{ datasetData.datasetId }}</span>
      </div>

      <div class="form-group">
        <label for="dataset-name">{{ 'datasetname' | translate }} *</label>
        <input
          id="dataset-name"
          type="text"
          formControlName="datasetName"
          pattern="[a-zA-Z0-9\\_\\]+"
          (blur)="saveTempData()"
        />
        <div
          class="messages"
          *ngIf="
            datasetForm.enabled &&
            datasetForm.controls.datasetName.dirty &&
            !datasetForm.controls.datasetName.valid
          "
        >
          <div class="error-message">{{ 'datasetnamevalidator' | translate }}</div>
        </div>
      </div>

      <div class="form-group">
        <label for="data-provider">{{ 'dataprovider' | translate }}</label>
        <input
          id="data-provider"
          type="text"
          formControlName="dataProvider"
          (blur)="saveTempData()"
        />
      </div>
      <div class="form-group">
        <label for="provider">{{ 'provider' | translate }} *</label>
        <input id="provider" type="text" formControlName="provider" (blur)="saveTempData()" />
        <div
          class="messages"
          *ngIf="
            datasetForm.enabled &&
            datasetForm.controls.provider.dirty &&
            !datasetForm.controls.provider.valid
          "
        >
          <div class="error-message">{{ 'fieldrequired' | translate }}</div>
        </div>
      </div>
      <div class="form-group">
        <label for="intermediate-provider">{{ 'intermediateprovider' | translate }}</label>
        <input
          id="intermediate-provider"
          type="text"
          formControlName="intermediateProvider"
          (blur)="saveTempData()"
        />
      </div>

      <div class="form-group" *ngIf="!isNew">
        <label>{{ 'datecreated' | translate }}</label>
        <span>{{ datasetData.createdDate | date: 'dd/MM/yyyy - HH:mm' }}</span>
      </div>
      <div class="form-group" *ngIf="!isNew">
        <label>{{ 'dateupdated' | translate }}</label>
        <span>{{ datasetData.updatedDate | date: 'dd/MM/yyyy - HH:mm' }}</span>
      </div>

      <div class="form-group">
        <label for="replaces">{{ 'replaces' | translate }}</label>
        <input id="replaces" formControlName="replaces" (blur)="saveTempData()" />
      </div>
      <div class="form-group">
        <label for="replaced-by">{{ 'replacedby' | translate }}</label>
        <input id="replaced-by" formControlName="replacedBy" (blur)="saveTempData()" />
      </div>
      <div class="form-group">
        <label for="country">{{ 'country' | translate }} *</label>
        <select id="country" formControlName="country" (blur)="saveTempData()">
          <option *ngIf="isNew" value="0"></option>
          <option *ngFor="let c of countryOptions" [ngValue]="c">{{ c.name }}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="language">{{ 'language' | translate }} *</label>
        <select id="language" formControlName="language" (blur)="saveTempData()">
          <option *ngIf="isNew" value="0"></option>
          <option *ngFor="let l of languageOptions" [ngValue]="l">{{ l.name }}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="description">{{ 'description' | translate }}</label>
        <textarea id="description" formControlName="description" (blur)="saveTempData()"></textarea>
      </div>
      <div class="form-group">
        <label for="notes">{{ 'notes' | translate }}</label>
        <textarea id="notes" formControlName="notes" (blur)="saveTempData()"></textarea>
      </div>

      <div class="form-group" *ngIf="!isNew">
        <label>{{ 'createdby' | translate }}</label> <span>{{ datasetData.createdByUserId }}</span>
      </div>
      <div *ngIf="!isNew && harvestPublicationData">
        <div class="form-group">
          <label>{{ 'firstpublished' | translate }}</label>
          <span>{{ harvestPublicationData.firstPublishedDate | date: 'dd/MM/yyyy - HH:mm' }}</span>
        </div>
        <div class="form-group">
          <label>{{ 'lastpublished' | translate }}</label>
          <span>{{ harvestPublicationData.lastPublishedDate | date: 'dd/MM/yyyy - HH:mm' }}</span>
        </div>
        <div class="form-group">
          <label>{{ 'numberpublished' | translate }}</label>
          <span>{{ harvestPublicationData.lastPublishedRecords }}</span>
        </div>
        <div class="form-group">
          <label>{{ 'lastharvest' | translate }}</label>
          <span>{{ harvestPublicationData.lastHarvestedDate | date: 'dd/MM/yyyy - HH:mm' }}</span>
        </div>
        <div class="form-group">
          <label>{{ 'numberharvested' | translate }}</label>
          <span>{{ harvestPublicationData.lastHarvestedRecords }}</span>
        </div>
      </div>

      <div class="form-group form-group-btns user-profile-edit-btns">
        <button class="submit" type="button" *ngIf="formMode === 'show'" (click)="editForm()">
          {{ 'edit' | translate }}
        </button>
        <button class="reset-btn" type="button" *ngIf="formMode === 'edit'" (click)="cancel()">
          {{ 'cancel' | translate }}
        </button>
        <app-loading-button
          *ngIf="formMode !== 'show'"
          [classes]="'submit'"
          [disabled]="!datasetForm.valid"
          [isLoading]="formMode == 'save'"
          [title]="(isNew ? 'create' : 'save') | translate"
          [loadingTitle]="(isNew ? 'creating' : 'saving') | translate"
          (click)="onSubmit()"
        ></app-loading-button>
      </div>
    </div>
  </form>
</div>
