<div class="metis-dataset-info-block dataset-actionbar" *ngIf="lastExecutionData">
  <div class="status">
    <strong
      class="uppercase tooltip"
      attr.data-tooltip="{{ 'doubleclicktocopy' | translate }}"
      (dblclick)="copyInformation('plugin', currentExternalTaskId || '', currentPlugin!.id)"
      >{{ currentPluginName! | renameWorkflow }}</strong
    >
    {{ currentStatus! | uppercase }}
  </div>
  <div class="progress">
    <div class="progress-status" *ngIf="currentStatus === 'RUNNING' || currentStatus === 'INQUEUE'">
      <span class="progress-statusnumbers"
        >{{ totalProcessed }} <span class="errors" *ngIf="totalErrors">({{ totalErrors }})</span> /
        {{ totalInDataset >= 0 ? totalInDataset : ('unknown' | translate) }}</span
      >
      <span class="progress-percentage"
        >{{
          workflowPercentage >= 0
            ? (workflowPercentage | number: '1.0-0')
            : ('unknown' | translate)
        }}%</span
      >
    </div>
    <div class="progressbar" *ngIf="currentStatus === 'RUNNING' || currentStatus === 'INQUEUE'">
      <div
        class="progressbar-done"
        [style.width.%]="workflowPercentage >= 0 ? workflowPercentage : 0"
      ></div>
    </div>
  </div>
  <div class="datetime">
    <span class="date">{{ now | date: 'dd/MM/yyyy' }}</span>
    <span class="datedivider" *ngIf="now">-</span>
    <span class="time">{{ now | date: 'HH:mm' }}</span>
  </div>
  <nav>
    <ul>
      <li
        *ngIf="
          (currentStatus === 'RUNNING' || currentStatus === 'INQUEUE') &&
          (currentPluginName !== 'PUBLISH' && currentPluginName !== 'MEDIA_PROCESS')
        "
      >
        <a
          class="cancel-btn svg-icon-cancel tooltip"
          attr.data-tooltip="{{ 'cancel' | translate }}"
          (click)="cancelWorkflow()"
          ><span>{{ 'cancel' | translate }}</span></a
        >
      </li>
      <li>
        <a
          class="log-btn svg-icon-log tooltip"
          attr.data-tooltip="{{ 'log' | translate }}"
          (click)="showLog()"
          *ngIf="currentStatus !== 'INQUEUE' && currentExternalTaskId && currentTopology"
          ><span>{{ 'log' | translate }}</span></a
        >
      </li>
      <li *ngIf="totalErrors > 0 && currentExternalTaskId && currentTopology">
        <a
          class="report-btn svg-icon-report tooltip"
          attr.data-tooltip="{{ 'report' | translate }}"
          (click)="openReport(currentExternalTaskId, currentTopology)"
          ><span>{{ 'report' | translate }}</span></a
        >
      </li>
      <li
        *ngIf="
          (currentStatus === 'CANCELLED' ||
            currentStatus === 'FINISHED' ||
            currentStatus === 'FAILED') &&
          !isStarting
        "
      >
        <a class="newaction-btn" (click)="startWorkflow.emit()">
          <span>{{ 'run workflow' | translate }}</span>
        </a>
      </li>
    </ul>
  </nav>
</div>

<div class="metis-dataset-info-block dataset-actionbar" *ngIf="!lastExecutionData && !isStarting">
  <div class="status status-new">{{ 'start workflow' | translate }}</div>
  <nav *ngIf="workflowData">
    <ul>
      <li>
        <a class="newaction-btn" (click)="startWorkflow.emit()">
          <span>{{ 'run workflow' | translate }}</span>
        </a>
      </li>
    </ul>
  </nav>
</div>
