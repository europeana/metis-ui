<ng-template #childComponentTemplate>
  <ng-template #empty_date><span class="time">--</span></ng-template>

  <span [ngClass]="{ active: expanded }" class="grid-cell row-start" (click)="toggleExpand($event)">
    {{ dsExecution.dataset.datasetName }}
    <span class="br">
      <a [routerLink]="['/dataset', 'edit', dsExecution.dataset.datasetId]" target="_blank">{{
        dsExecution.dataset.datasetId
      }}</a>
    </span>
  </span>

  <span class="grid-cell">
    {{ dsExecution.execution.executionProgress.stepsDone }} /
    {{ dsExecution.execution.executionProgress.stepsTotal }} {{ 'overviewsteps' | translate }}
    <ul
      *ngIf="dsExecution.execution.metisPlugins && dsExecution.execution.metisPlugins.length > 0"
      class="orbs"
    >
      <li
        *ngFor="let pi of dsExecution.execution.metisPlugins"
        class="{{ pi.pluginType }} orb-status {{ getPluginStatusClass(pi) }}"
      ></li>
    </ul>
  </span>

  <span class="grid-cell">
    {{ dsExecution.execution.executionProgress.currentPluginProgress.processedRecords }} /
    {{ dsExecution.execution.executionProgress.currentPluginProgress.expectedRecords }}
    <span
      *ngIf="
        dsExecution.execution.executionProgress.currentPluginProgress.errors &&
        dsExecution.execution.executionProgress.currentPluginProgress.errors > 0
      "
      class="br error-count"
    >
      {{ dsExecution.execution.executionProgress.currentPluginProgress.errors }}
    </span>
  </span>

  <span class="grid-cell">
    <span *ngIf="dsExecution.execution.startedDate; else empty_date">
      {{ dsExecution.execution.startedDate | date: 'dd/MM/yyyy' }}
      <span class="br time">
        {{ dsExecution.execution.startedDate | date: 'HH:mm' }}
      </span>
    </span>
  </span>

  <span class="grid-cell">
    <span *ngIf="dsExecution.execution.finishedDate; else empty_date">
      {{ dsExecution.execution.finishedDate | date: 'dd/MM/yyyy' }}
      <span class="br time">{{ dsExecution.execution.finishedDate | date: 'HH:mm' }}</span>
    </span>
  </span>

  <ng-container *ngIf="expanded">
    <ng-container *ngFor="let pi of dsExecution.execution.metisPlugins">
      <span class="grid-sub start labelled-orb">
        <span class="{{ pi.pluginType }} orb-status {{ getPluginStatusClass(pi) }}"></span>
        <span
          class="tooltip"
          title="{{ 'doubleclicktocopy' | translate }}"
          (dblclick)="copyInformation('plugin', pi.externalTaskId || '', pi.id)"
        >
          {{ pi.pluginType | renameWorkflow }}
          <span class="status-label">{{ pi.pluginStatus }}</span>
        </span>
      </span>

      <span class="grid-sub">
        <span class="inline-block">
          {{ pi.executionProgress.processedRecords }} / {{ pi.executionProgress.expectedRecords }}
        </span>
        <span
          *ngIf="pi.executionProgress.errors && pi.executionProgress.errors > 0"
          class="error-count"
        >
          {{ pi.executionProgress.errors }}
        </span>
      </span>

      <span class="grid-sub dates">
        <span *ngIf="pi.startedDate; else empty_date" class="inline-block">
          {{ pi.startedDate | date: 'dd/MM/yyyy' }}
          <span class="time">
            {{ pi.startedDate | date: 'HH:mm' }}
          </span>
          <span *ngIf="pi.finishedDate; else empty_date" class="inline-block">
            {{ pi.finishedDate | date: 'dd/MM/yyyy' }}
            <span class="time">
              {{ pi.finishedDate | date: 'HH:mm' }}
            </span>
          </span>
        </span>
      </span>
    </ng-container>
  </ng-container>
</ng-template>
