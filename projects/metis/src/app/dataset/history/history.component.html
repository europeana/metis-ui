<ng-template #empty_date><span class="date-and-time"></span></ng-template>

<app-notification
  [notification]="notification"
  (closed)="notification = undefined"
></app-notification>

<div class="table-grid history">
  <ng-container *ngFor="let wpe of allExecutions; trackBy: byId; let i = index">
    <ng-container *ngIf="!wpe.pluginExecution && wpe.execution; let execution">
      <div
        class="head-text-wrapper"
        (dblclick)="copyInformation('execution', execution.id, execution.ecloudDatasetId)"
        title="{{ 'doubleClickToCopy' | translate }}"
      >
        <span class="head-text workflow">
          <span class="head-prefix workflow">{{ 'workflowCreated' | translate }} </span>
          {{ resetTemplateRowIndex() }}
          <span class="head-date">
            {{ execution.createdDate | date: 'dd/MM/yyyy' }}
          </span>
          {{ execution.createdDate | date: 'HH:mm' }}
          <ng-container *ngIf="getCancelledBy(execution) | async as canceller">
            <span class="head-prefix canceller">{{ 'cancelledBy' | translate }}</span>
            {{ canceller }}
          </ng-container>
        </span>
      </div>

      <div class="grid-header small-title">
        {{ 'workflowStep' | translate }}
      </div>
      <div
        class="grid-header small-title"
        i18n="label grid header processed @@labelGridHeaderProcessed"
      >
        {{ 'processedRecords' | translate }}
      </div>
      <div class="grid-header small-title">
        {{ 'startTime' | translate }}
      </div>
      <div class="grid-header small-title">
        {{ 'endTime' | translate }}
      </div>
      <div class="grid-header small-title">
        {{ 'actions' | translate }}
      </div>
    </ng-container>

    <ng-container *ngIf="wpe.pluginExecution">
      <app-executions-grid-data
        #dataWrapper
        id="app-executions-grid-data"
        [applyStripe]="rowIsStripe()"
        [plugin]="wpe.pluginExecution"
        [wpe]="wpe"
        (openPreview)="goToPreview($event)"
        (setReportMsg)="openFailReport($event)"
      ></app-executions-grid-data>
      <ng-content *ngTemplateOutlet="dataWrapper.gridDataTemplate"></ng-content>
    </ng-container>
  </ng-container>

  <span
    *ngIf="maxResultsReached"
    class="table-grid-footer warning"
    i18n="max result reached|max result reached message@@maxResultsReached"
  >
    You've reached the limit of the number of executions that can be displayed ({{ maxResults }})
  </span>

  <a *ngIf="hasMore" class="table-button" (click)="loadNextPage()">{{ 'loadMore' | translate }}</a>
</div>
